To handle cookies in an Express.js application, you typically use the `cookie-parser` middleware to parse cookies from incoming requests and set cookies in responses. Below is a concise guide on how to set up and use cookies in an Express.js app.

### 1. **Install Required Packages**
You need Express.js and the `cookie-parser` middleware. Install them using npm:

```bash
npm install express cookie-parser
```

### 2. **Set Up the Express App with Cookie-Parser**
Create a basic Express app and configure `cookie-parser`.

```javascript
const express = require('express');
const cookieParser = require('cookie-parser');

const app = express();

// Use cookie-parser middleware
app.use(cookieParser());

const PORT = 3000;
app.listen(PORT, () => console.log(`Server running on port ${PORT}`));
```

### 3. **Setting a Cookie**
You can set a cookie in a response using `res.cookie()`. Here's an example:

```javascript
app.get('/set-cookie', (req, res) => {
  // Set a cookie named 'user' with value 'john_doe'
  res.cookie('user', 'john_doe', {
    maxAge: 1000 * 60 * 60, // 1 hour in milliseconds
    httpOnly: true, // Cookie is not accessible via client-side JavaScript
    secure: process.env.NODE_ENV === 'production', // Only send over HTTPS in production
    sameSite: 'strict', // Prevent CSRF by restricting cookie sharing
  });
  res.send('Cookie has been set!');
});
```

- **`maxAge`**: Sets the cookie expiration time (in milliseconds).
- **`httpOnly`**: Prevents client-side access to the cookie (enhances security).
- **`secure`**: Ensures the cookie is sent only over HTTPS (set to `true` in production).
- **`sameSite`**: Controls cross-site request behavior (`'strict'`, `'lax'`, or `'none'`).

### 4. **Reading Cookies**
You can access cookies from the request object using `req.cookies`.

```javascript
app.get('/get-cookie', (req, res) => {
  // Read the 'user' cookie
  const user = req.cookies.user || 'No user cookie found';
  res.send(`User cookie: ${user}`);
});
```

### 5. **Clearing a Cookie**
To remove a cookie, use `res.clearCookie()`.

```javascript
app.get('/clear-cookie', (req, res) => {
  // Clear the 'user' cookie
  res.clearCookie('user');
  res.send('Cookie has been cleared!');
});
```

### 6. **Signed Cookies (Optional)**
For added security, you can sign cookies to prevent tampering. To use signed cookies, initialize `cookie-parser` with a secret key:

```javascript
app.use(cookieParser('your-secret-key')); // Secret for signing cookies

// Set a signed cookie
app.get('/set-signed-cookie', (req, res) => {
  res.cookie('session', '12345', { signed: true });
  res.send('Signed cookie set!');
});

// Read a signed cookie
app.get('/get-signed-cookie', (req, res) => {
  const session = req.signedCookies.session || 'No signed cookie found';
  res.send(`Signed cookie: ${session}`);
});
```

- **Note**: If a signed cookie is tampered with, `req.signedCookies` will return `false` for that cookie.

### 7. **Full Example**
Hereâ€™s a complete Express.js app demonstrating cookie handling:

```javascript
const express = require('express');
const cookieParser = require('cookie-parser');

const app = express();
app.use(cookieParser('your-secret-key')); // Secret for signed cookies

// Set a cookie
app.get('/set-cookie', (req, res) => {
  res.cookie('user', 'john_doe', {
    maxAge: 1000 * 60 * 60, // 1 hour
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    sameSite: 'strict',
  });
  res.send('Cookie set!');
});

// Set a signed cookie
app.get('/set-signed-cookie', (req, res) => {
  res.cookie('session', '12345', { signed: true });
  res.send('Signed cookie set!');
});

// Read cookies
app.get('/get-cookie', (req, res) => {
  const user = req.cookies.user || 'No user cookie';
  const session = req.signedCookies.session || 'No signed session cookie';
  res.send(`User: ${user}, Session: ${session}`);
});

// Clear a cookie
app.get('/clear-cookie', (req, res) => {
  res.clearCookie('user');
  res.send('Cookie cleared!');
});

const PORT = 3000;
app.listen(PORT, () => console.log(`Server running on port ${PORT}`));
```

### 8. **Testing the App**
- Run the app with `node app.js` (assuming the file is named `app.js`).
- Use a browser or a tool like Postman to test the endpoints:
  - `GET /set-cookie`: Sets a cookie named `user`.
  - `GET /set-signed-cookie`: Sets a signed cookie named `session`.
  - `GET /get-cookie`: Reads both cookies.
  - `GET /clear-cookie`: Clears the `user` cookie.

### 9. **Security Best Practices**
- **Use `httpOnly`**: Prevents client-side scripts from accessing cookies.
- **Enable `secure` in production**: Ensures cookies are sent over HTTPS.
- **Set `sameSite: 'strict'` or `'lax'`: Mitigates CSRF attacks.
- **Use signed cookies**: Protects against tampering for sensitive data.
- **Set reasonable expiration times**: Avoid overly long-lived cookies.
- **Avoid storing sensitive data in cookies**: Use server-side sessions (e.g., `express-session`) for sensitive data.

### 10. **Common Use Cases**
- **Authentication**: Store session IDs or tokens (preferably in signed cookies or sessions).
- **User Preferences**: Save user settings (e.g., theme preference).
- **Tracking**: Store tracking IDs for analytics.
